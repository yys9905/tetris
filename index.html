<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Tetris</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="stylesheet" type="text/css" href="tetris.css">
    <script type="text/javascript" src="tetris.js"></script>
    <style>
      /* 모바일 환경에서 불필요한 요소 숨기고 테트리스만 */
      @media (max-width: 800px) {
        body, html {
          margin: 0 !important;
          padding: 0 !important;
          width: 100vw;
          height: 100vh;
          overflow: hidden;
          background: #222;
        }
        h1, h2, .tetris-panel-container, .textlocation, 
        #controlTextContent, #updateTextContent, 
        table:not(:has(#stage)) {
          display: none !important;
        }
        .wrapper-container, .tetris-container, #stage {
          width: 100vw !important;
          height: 100vh !important;
          max-width: 100vw !important;
          max-height: 100vh !important;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        #stage {
          width: 100vw !important;
          height: 100vh !important;
          display: block;
          background: black;
        }
      }
    </style>
  </head>
  <body>
    <table>
      <tr>
        <td>
          <h1>테트리스</h1>
        </td>
      </tr>
      <tr>
        <td>
          <div class="wrapper-container">
              <span class="tetris-container">
                  <canvas id="stage" width="250px" height="500px" style="background-color:black;">
                  </canvas>
                  <span class="tetris-panel-container">
                    <p>Next:</p>
                      <canvas id="next" width="150px" height="150px" style="background-color:black;">
                      </canvas>
                    <p>Lines:<span id="lines">0</span></p>
                    <p>Level:<span id="level">1</span></p>
                    <p><span id="message"></span></p>
                    <div class="tetris-panel-container-padding"></div>
                    <table class="tetris-button-panel">
                      <tr>
                        <td id="tetris-pause-button" class="tetris-button">P</td>
                        <td></td>
                        <td id="tetris-reset-button" class="tetris-button">R</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td id="tetris-rotate-button" class="tetris-button">↻</td>
                        <td></td>
                      </tr>
                      <tr>
                        <td id="tetris-move-left-button"class="tetris-button">←</td>
                        <td id="tetris-down-button"class="tetris-button">↓</td>
                        <td id="tetris-move-right-button"class="tetris-button">→</td>
                      </tr>
                      <tr>
                        <td colspan="3" id="tetris-fall-button" class="tetris-button">Space</td>
                      </tr>
                    </table>
                  </span>
              </span>
          </div>
        </td>
        <td>
          <table>
            <tr>
              <h2 class="mouseOn" onclick="control()">조작법</h2>
              <div id="controlTextContent" style="display: block">
                <p class="content">← : 왼쪽으로 이동</p>
                <p class="content">→ : 오른쪽으로 이동</p>
                <p class="content">↑ : 회전</p>
                <p class="content">↓ : 아래로 한칸 이동</p>
                <p class="content">Space : 아래로 빠르게 이동</p>
                <p class="content">Esc/P : 정지/시작</p>
                <p class="content">R : 게임 초기화</p>
              </div> 
            </tr>
            <tr>
              <h2 class="mouseOn" onclick="update()">Update</h2>
              <div id="updateTextContent" style="display: none">
                <p class="upDate" onclick="upText()">22.02.08</p>
                <div id = "firstUp" style="display: none">
                  <p class="title">@ 부숴진 라인의 수에 따른 레벨시스템 추가</p>
                  <p class="content">    * line 20 -> 1Lv</p>
                  <p class="title">@ 레벨에 따른 속도증가 시스템 추가</p>
                  <p class="content">    * 속도 증가 최대레벨 20Lv</p>
                </div>
                <hr>
                <p class="mouseOn" onclick="upText2()">25.07.22</p>
                <div id = "secondUp" style="display: none">
                  <p class="title">@ 편의성 개선</p>
                  <p class="content">    * NextBlock 가운데 정렬</p>
                  <p class="content">    * 아래로 한칸 이동 추가</p>
                  <p class="content">    * 착지 예상 위치 추가</p>
                  <p class="title">@ 오류 수정</p>
                  <p class="content">    * 정지시 한틱 더 이동하던 현상 수정</p>
                  <p class="content">    * 블록 생성 전 이동시 오류 띄우던 현상 수정</p>
                </div>
              </div>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    <p class="textlocation">made by ys</p>
    <script>
      function control() {
        if (document.getElementById('controlTextContent').style.display == 'none') {
          document.getElementById('updateTextContent').style.display = 'none';
          document.getElementById('controlTextContent').style.display = 'block';
        } else {
          document.getElementById('controlTextContent').style.display = 'none';
        }
      }
      function update() {
        if (document.getElementById('updateTextContent').style.display == 'none') {
          document.getElementById('controlTextContent').style.display = 'none';
          document.getElementById('firstUp').style.display = 'none';
          document.getElementById('secondUp').style.display = 'none';
          document.getElementById('updateTextContent').style.display = 'block';
        } else {
          document.getElementById('updateTextContent').style.display = 'none';
        }
      }
      function upText(){
        if (document.getElementById('firstUp').style.display == 'none'){
          document.getElementById('secondUp').style.display = 'none';
          document.getElementById('firstUp').style.display = 'block';}
        else{
          document.getElementById('firstUp').style.display = 'none';
        }
      }
      function upText2(){
        if (document.getElementById('secondUp').style.display == 'none'){
          document.getElementById('firstUp').style.display = 'none';
          document.getElementById('secondUp').style.display = 'block';}
        else{
          document.getElementById('secondUp').style.display = 'none';
        }
      }
      var tetris = new Tetris();
      tetris.startGame();
      window.tetris = tetris; // 전역 접근

      // 모바일에서 캔버스가 꽉 차게
      function resizeCanvasForMobile() {
        if (window.innerWidth < 800) {
          var stage = document.getElementById("stage");
          stage.width = window.innerWidth;
          stage.height = window.innerHeight;
          if (window.tetris) tetris.reset();
        }
      }
      window.addEventListener('resize', resizeCanvasForMobile);
      window.addEventListener('DOMContentLoaded', resizeCanvasForMobile);
    </script>
  </body>
</html>
